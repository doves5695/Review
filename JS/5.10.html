<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <script>
        // async/await的优势
        // 如果只是单一的promise链并不能发现async/await的优势, 但是, 如果需要处理由多个promise组成的then链的时候, 优势就能体现出来了


        // 例1:
        // function takeLongTime(n) {
        //     return new Promise (resolve => {
        //         setTimeout(() => {
        //             resolve(n+200)
        //         }, n);
        //     });
        // }
        // function step1(n) {
        //     console.log(`step1 with ${n}`);
        //     return takeLongTime(n);
        // }
        // function step2(n) {
        //     console.log(`step2 with ${n}`);
        //     return takeLongTime(n);
        // }
        // function step3(n) {
        //     console.log(`step3 with ${n}`);
        //     return takeLongTime(n);
        // }


        // async function doIt() {
        //     console.time('doIt');
        //     const time1 = 300;
        //     // step1(time1)
        //     //     .then(time2 => step2(time2))
        //     //     .then(time3 => step3(time3))
        //     //     .then(result => {
        //     //         console.log(`result is ${result}`)
        //     //         console.timeEnd('doIt');
        //     //     })
        //     const time2 = await step1(time1);
        //     const time3 = await step2(time2);
        //     const result = await step3(time3);
        //     console.log(`result is ${result}`)
        //     console.timeEnd('doIt');
        // }
        // doIt();


        
        // 例2:
        // function sendRequest () {
        //     return new Promise((resolve, reject) => {
        //         setTimeout(()=> {
        //             resolve('jack')
        //             reject(new Error('出错拉'));
        //         },2000);
        //     });
        // }
       

        // async function getUserName () {
        //     try {
        //         let username = await sendRequest();
        //         console.log(username);
        //     } catch (error) {
        //         console.log(error);
        //     }
        // }
        // getUserName();

        // Async 和 Await更贴近同步执行代码, 由promise基础演变, 在async函数当中要想获取错误,需要用到try...catch


        // async和await相对于promise的优势
        // 代码读起来更加同步，Promise虽然摆脱了回调地狱，但是then的链式调⽤也会带来额外的阅读负担
        // Promise传递中间值⾮常麻烦，⽽async/await⼏乎是同步的写法，⾮常优雅
        // 错误处理友好，async/await可以⽤成熟的try/catch，Promise的错误捕获⾮常冗余
        // 调试友好，Promise的调试很差，由于没有代码块，你不能在⼀个返回表达式的箭头函数中设置断点，如果你在⼀个.then代码块中使⽤调试器的步进(step-over)功能，调试器并不会进⼊后续的.then代码块，因为调试器只能跟踪同步代码的每⼀步




    </script>
</body>
</html>